<!DOCTYPE html>
<html lang="si">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>RASHU MD | Pair Code</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1: #0f172a;
      --bg2: #0b1020;
      --accent1: #ff3b3b;
      --accent2: #ff9a9a;
      --glass: rgba(255,255,255,0.06);
      --glass-2: rgba(255,255,255,0.04);
      --radius: 18px;
      --text: #ffffff;
      --muted: rgba(255,255,255,0.7);
      --success: #32cd32;
      --transition: 300ms cubic-bezier(.2,.9,.3,1);
      --max-width: 460px;
    }
    *{box-sizing:border-box;margin:0;padding:0;font-family:'Poppins',sans-serif}
    html,body{height:100%}
    body{
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
      color:var(--text);
      background:linear-gradient(120deg,var(--bg1),var(--bg2));
      overflow-x:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .bg-anim{
      position:fixed;inset:0;z-index:-3;
      background: linear-gradient(120deg, #071029 0%, #0e203a 25%, #2a0f2f 50%, #071029 75%, #0b1020 100%);
      background-size: 200% 200%;
      animation: gradientShift 12s ease infinite;
      filter: blur(28px) saturate(110%);
      transform: scale(1.02);
      opacity:.95;
    }
    @keyframes gradientShift{
      0%{background-position:0% 50%}
      50%{background-position:100% 50%}
      100%{background-position:0% 50%}
    }
    .bg-overlay{
      position:fixed;inset:0;z-index:-2;
      background: radial-gradient(1200px 600px at 10% 10%, rgba(255,60,60,0.06), transparent 6%),
                  radial-gradient(900px 500px at 90% 85%, rgba(0,120,255,0.03), transparent 6%);
      pointer-events:none;
    }
    .card{
      width:100%;
      max-width:var(--max-width);
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      border-radius:var(--radius);
      padding:28px 20px;
      box-shadow: 0 10px 30px rgba(2,6,23,0.6), 0 2px 8px rgba(0,0,0,0.5);
      backdrop-filter: blur(10px) saturate(120%);
      border: 1px solid rgba(255,255,255,0.04);
      position:relative;
      overflow:hidden;
      transform-origin:center;
      transition: transform var(--transition), box-shadow var(--transition);
    }
    .card:active{ transform: translateY(2px) scale(.998) }
    .top{ display:flex; align-items:center; gap:14px; margin-bottom:14px; }
    .avatar{
      width:84px;height:84px;border-radius:50%;
      display:inline-flex;align-items:center;justify-content:center;
      background:linear-gradient(135deg,var(--accent1),var(--accent2));
      box-shadow:0 8px 30px rgba(255,30,30,0.12), inset 0 -6px 18px rgba(0,0,0,0.18);
      border:4px solid rgba(255,255,255,0.06);
      flex-shrink:0;
      transition: transform var(--transition);
      overflow:hidden;
    }
    .avatar img{ width:100%; height:100%; object-fit:cover; display:block; }
    .title{
      font-weight:700;font-size:20px; line-height:1.05;
      -webkit-background-clip:text;background-clip:text;
      background: linear-gradient(90deg,var(--accent1),var(--accent2));
      color:transparent;
    }
    .subtitle{ font-size:13px; color:var(--muted); margin-top:6px }
    .controls{ margin-top:8px; display:flex; gap:12px; flex-direction:column; align-items:stretch }
    .country-wrapper{ position:relative; }
    .country-input{
      width:100%;
      padding:14px 14px;
      border-radius:12px;
      font-size:15px;
      background: var(--glass);
      border: 1px solid rgba(255,255,255,0.03);
      color:var(--text);
      outline:none;
      transition: box-shadow var(--transition), border-color var(--transition);
    }
    .country-input:focus{ box-shadow: 0 6px 22px rgba(83,31,31,0.12); border-color: rgba(255,60,60,0.24) }
    .phone-input{
      width:100%;
      padding:14px 14px;
      border-radius:12px;
      font-size:17px;
      background: var(--glass-2);
      border: 1px solid rgba(255,255,255,0.03);
      color:var(--text);
      text-align:center;
      outline:none;
      transition: box-shadow var(--transition), border-color var(--transition);
    }
    .phone-input::placeholder{ color:rgba(255,255,255,0.45) }
    .phone-input:focus{ box-shadow: 0 6px 22px rgba(31,31,83,0.08); border-color: rgba(255,60,60,0.24) }
    .submit-btn{
      width:100%;
      padding:14px;
      border-radius:12px;
      border:none;
      font-weight:600;
      font-size:16px;
      cursor:pointer;
      background: linear-gradient(90deg,var(--accent1),var(--accent2));
      color:white;
      box-shadow: 0 10px 30px rgba(255,30,30,0.14);
      transition: transform var(--transition), box-shadow var(--transition);
    }
    .submit-btn:active{ transform: translateY(2px) }
    .result{
      margin-top:14px;
      min-height:54px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      flex-direction:column;
    }
    .code-box{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:10px 14px;
      border-radius:12px;
      border:1.2px dashed rgba(255,255,255,0.08);
      background: rgba(0,0,0,0.36);
      cursor:pointer;
      user-select:all;
      font-weight:700;
      font-size:18px;
      transition: transform var(--transition), background var(--transition), border-style var(--transition);
    }
    .code-box:active{ transform:scale(.995) }
    .copy-hint{ font-size:12px;color:var(--muted); margin-top:6px }
    .muted{ color:var(--muted); font-size:13px }
    .audio-toggle{
      position:fixed; right:18px; bottom:18px; z-index:40;
      width:56px;height:56px;border-radius:14px;
      display:flex;align-items:center;justify-content:center;
      background: linear-gradient(180deg, rgba(255,40,40,0.95), rgba(255,20,20,0.95));
      box-shadow:0 12px 30px rgba(0,0,0,0.45);
      border:1px solid rgba(255,255,255,0.06);
      color:white; cursor:pointer;
      -webkit-tap-highlight-color: transparent;
    }
    #rcMsg{
      display:none;position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);
      background:rgba(0,0,0,0.7);padding:12px 20px;border-radius:12px;
      border:1px solid rgba(255,60,60,0.18);color:var(--accent2);font-weight:600;
      z-index:60;
    }
    @media (max-width:480px){
      :root{ --max-width: 420px }
      .card{ padding:20px; border-radius:16px }
      .avatar{ width:72px;height:72px }
      .title{ font-size:18px }
      .phone-input{ font-size:16px;padding:13px 12px }
      .country-input{ font-size:15px;padding:12px }
      .submit-btn{ padding:13px;font-size:15px;border-radius:12px }
      .audio-toggle{ width:50px;height:50px;border-radius:12px;right:14px;bottom:14px }
    }
    @media (prefers-reduced-motion: reduce){
      .bg-anim{ animation:none }
      .card, .avatar, .submit-btn { transition:none }
    }
    .waiting{ color:var(--muted); font-weight:600 }
    .copied{ color:var(--success); font-weight:700 }
  </style>
</head>
<body>
  <div class="bg-anim" aria-hidden="true"></div>
  <div class="bg-overlay" aria-hidden="true"></div>

  <main class="card" role="main" aria-labelledby="pair-title">
    <div class="top" aria-hidden="false">
      <div class="avatar" aria-hidden="true">
        <img src="https://i.ibb.co/fzbhtLB5/tourl-1762675714129.jpg" alt="RASHU MD">
      </div>
      <div style="flex:1;text-align:left">
        <div id="pair-title" class="title">RASHU MD</div>
        <div class="subtitle">Pair with Phone Number</div>
      </div>
    </div>

    <div class="controls" aria-live="polite">
      <div class="country-wrapper" style="width:100%">
        <input id="countrySearch" type="text" class="country-input" placeholder="Search country (e.g. Sri Lanka, India)..." inputmode="search" autocomplete="off" aria-label="Search country">
        <div id="countryDropdown" aria-hidden="true" style="position:relative;z-index:30"></div>
      </div>

      <input id="phoneNumber" class="phone-input" type="tel" inputmode="numeric" placeholder="77 123 4567" maxlength="20" aria-label="Phone number">
      <button id="submitBtn" class="submit-btn" aria-label="Get Pair Code">Get Pair Code</button>
      <div id="result" class="result" aria-live="polite"></div>
      <div class="muted" style="text-align:center;margin-top:8px">Right-click shows info</div>
    </div>
  </main>

  <button id="audioToggle" class="audio-toggle" aria-pressed="false" title="Toggle background audio">
    <i id="audioIcon" class="fas fa-play"></i>
  </button>

  <div id="rcMsg" role="status">RASHU MD © 2025</div>

  <audio id="bgAudio" loop preload="none">
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
  </audio>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>
  <script>
    const countries = [
  { name: "Sri Lanka", code: "+94" },
  { name: "India", code: "+91" },
  { name: "USA", code: "+1" },
  { name: "UK", code: "+44" },
  { name: "Australia", code: "+61" },
  { name: "Japan", code: "+81" },
  { name: "Germany", code: "+49" },
  { name: "France", code: "+33" },
  { name: "China", code: "+86" },
  { name: "Brazil", code: "+55" },
  { name: "Canada", code: "+1" },
  { name: "Russia", code: "+7" },
  { name: "South Korea", code: "+82" },
  { name: "North Korea", code: "+850" },
  { name: "Italy", code: "+39" },
  { name: "Spain", code: "+34" },
  { name: "Mexico", code: "+52" },
  { name: "Argentina", code: "+54" },
  { name: "Colombia", code: "+57" },
  { name: "Chile", code: "+56" },
  { name: "Peru", code: "+51" },
  { name: "Venezuela", code: "+58" },
  { name: "Belgium", code: "+32" },
  { name: "Netherlands", code: "+31" },
  { name: "Switzerland", code: "+41" },
  { name: "Sweden", code: "+46" },
  { name: "Norway", code: "+47" },
  { name: "Denmark", code: "+45" },
  { name: "Finland", code: "+358" },
  { name: "Poland", code: "+48" },
  { name: "Czech Republic", code: "+420" },
  { name: "Greece", code: "+30" },
  { name: "Portugal", code: "+351" },
  { name: "Ireland", code: "+353" },
  { name: "New Zealand", code: "+64" },
  { name: "South Africa", code: "+27" },
  { name: "Egypt", code: "+20" },
  { name: "Morocco", code: "+212" },
  { name: "Nigeria", code: "+234" },
  { name: "Kenya", code: "+254" },
  { name: "Uganda", code: "+256" },
  { name: "Ghana", code: "+233" },
  { name: "Thailand", code: "+66" },
  { name: "Vietnam", code: "+84" },
  { name: "Malaysia", code: "+60" },
  { name: "Singapore", code: "+65" },
  { name: "Indonesia", code: "+62" },
  { name: "Philippines", code: "+63" },
  { name: "Pakistan", code: "+92" },
  { name: "Bangladesh", code: "+880" },
  { name: "Nepal", code: "+977" },
  { name: "Bhutan", code: "+975" },
  { name: "Maldives", code: "+960" },
  { name: "Turkey", code: "+90" },
  { name: "Saudi Arabia", code: "+966" },
  { name: "UAE", code: "+971" },
  { name: "Israel", code: "+972" },
  { name: "Iran", code: "+98" },
  { name: "Iraq", code: "+964" },
  { name: "Syria", code: "+963" },
  { name: "Jordan", code: "+962" },
  { name: "Lebanon", code: "+961" },
  { name: "Kuwait", code: "+965" },
  { name: "Oman", code: "+968" },
  { name: "Qatar", code: "+974" },
  { name: "Bahrain", code: "+973" },
  { name: "Yemen", code: "+967" },
  { name: "Afghanistan", code: "+93" },
  { name: "Sri Lanka", code: "+94" },
  { name: "Mongolia", code: "+976" },
  { name: "Kazakhstan", code: "+7" },
  { name: "Uzbekistan", code: "+998" },
  { name: "Tajikistan", code: "+992" },
  { name: "Kyrgyzstan", code: "+996" },
  { name: "Turkmenistan", code: "+993" },
  { name: "Armenia", code: "+374" },
  { name: "Azerbaijan", code: "+994" },
  { name: "Georgia", code: "+995" },
  { name: "Belarus", code: "+375" },
  { name: "Ukraine", code: "+380" },
  { name: "Lithuania", code: "+370" },
  { name: "Latvia", code: "+371" },
  { name: "Estonia", code: "+372" },
  { name: "Slovakia", code: "+421" },
  { name: "Slovenia", code: "+386" },
  { name: "Croatia", code: "+385" },
  { name: "Bosnia and Herzegovina", code: "+387" },
  { name: "Serbia", code: "+381" },
  { name: "Montenegro", code: "+382" },
  { name: "Albania", code: "+355" }
];
    const countrySearch = document.getElementById('countrySearch');
    const countryDropdown = document.getElementById('countryDropdown');
    const phoneInput = document.getElementById('phoneNumber');
    const submitBtn = document.getElementById('submitBtn');
    const resultBox = document.getElementById('result');
    const audio = document.getElementById('bgAudio');
    const audioToggle = document.getElementById('audioToggle');
    const audioIcon = document.getElementById('audioIcon');
    const rcMsg = document.getElementById('rcMsg');

    let selectedCode = "+94";
    let isPlaying = false;

    function renderCountries(filter = '') {
      countryDropdown.innerHTML = '';
      const q = filter.trim().toLowerCase();
      const list = countries.filter(c => c.name.toLowerCase().includes(q) || c.code.includes(q));
      if (!list.length) {
        countryDropdown.innerHTML = '<div style="padding:10px;color:rgba(255,255,255,0.6)">No country</div>';
        countryDropdown.style.display = 'block';
        return;
      }
      list.forEach(c => {
        const row = document.createElement('div');
        row.className = 'country-item';
        row.style.padding = '10px';
        row.style.borderBottom = '1px solid rgba(255,255,255,0.02)';
        row.style.display = 'flex';
        row.style.justifyContent = 'space-between';
        row.style.cursor = 'pointer';
        row.innerHTML = `<span style="font-weight:600">${c.name}</span><span style="opacity:.9">${c.code}</span>`;
        row.addEventListener('click', () => {
          selectedCode = c.code;
          countrySearch.value = `${c.name} ${c.code}`;
          countryDropdown.style.display = 'none';
          phoneInput.focus();
        });
        countryDropdown.appendChild(row);
      });
      countryDropdown.style.display = 'block';
      countryDropdown.style.position = 'absolute';
      countryDropdown.style.left = '0';
      countryDropdown.style.right = '0';
      countryDropdown.style.background = 'rgba(6,10,20,0.7)';
      countryDropdown.style.border = '1px solid rgba(255,255,255,0.03)';
      countryDropdown.style.borderRadius = '10px';
      countryDropdown.style.maxHeight = '260px';
      countryDropdown.style.overflowY = 'auto';
      countryDropdown.style.backdropFilter = 'blur(6px)';
      countryDropdown.style.zIndex = 80;
    }

    countrySearch.addEventListener('input', e => { renderCountries(e.target.value); });
    countrySearch.addEventListener('focus', () => renderCountries(''));
    document.addEventListener('click', (e) => {
      if (!countrySearch.contains(e.target) && !countryDropdown.contains(e.target)) {
        countryDropdown.style.display = 'none';
      }
    }, { passive: true });

    phoneInput.addEventListener('input', (e) => {
      let v = e.target.value.replace(/\D/g, '');
      v = v.slice(0, 12);
      if (v.length > 2 && v.length <= 6) v = v.slice(0,2) + ' ' + v.slice(2);
      else if (v.length > 6) v = v.slice(0,2) + ' ' + v.slice(2,6) + ' ' + v.slice(6);
      e.target.value = v;
    });

    submitBtn.addEventListener('click', async () => {
      const raw = phoneInput.value.replace(/\s/g, '');
      if (!raw || raw.length < 7) {
        resultBox.innerHTML = `<span class="waiting" style="color:#ff8b8b;font-weight:700">Invalid number</span>`;
        return;
      }
      const full = (selectedCode || '+94') + raw;
      resultBox.innerHTML = `<span class="waiting">Generating pair code…</span>`;
      try {
        const resp = await axios.get(`/code?number=${encodeURIComponent(full.replace('+',''))}`, { timeout: 10000 });
        const code = resp && resp.data && resp.data.code ? String(resp.data.code) : null;
        if (code) showCode(code);
        else resultBox.innerHTML = `<span style="color:#ff8b8b;font-weight:700">No code returned</span>`;
      } catch (err) {
        resultBox.innerHTML = `<span style="color:#ff8b8b;font-weight:700">Server error — try again</span>`;
      }
    });

    function showCode(code) {
      resultBox.innerHTML = '';
      const box = document.createElement('div');
      box.className = 'code-box';
      box.setAttribute('role','button');
      box.setAttribute('tabindex','0');
      box.innerHTML = `<span>CODE:</span>&nbsp;<span style="letter-spacing:1px">${code}</span>`;
      box.addEventListener('click', () => copyToClipboard(code, box));
      box.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') copyToClipboard(code, box); });
      resultBox.appendChild(box);
      const hint = document.createElement('div');
      hint.className = 'copy-hint';
      hint.textContent = 'Tap the code to copy';
      resultBox.appendChild(hint);
    }

    async function copyToClipboard(text, box) {
      try {
        await navigator.clipboard.writeText(text);
        box.classList.add('copied');
        const old = box.innerHTML;
        box.innerHTML = `<span style="color:var(--success);font-weight:800">COPIED!</span>`;
        setTimeout(()=> box.innerHTML = old, 900);
      } catch (e) {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try { document.execCommand('copy'); } catch(e) {}
        ta.remove();
        box.innerHTML = `<span style="color:var(--success);font-weight:800">COPIED!</span>`;
        setTimeout(()=> box.innerHTML = `CODE: <span style="letter-spacing:1px">${text}</span>`, 900);
      }
    }

    (function spawnSparks(){
      const container = document.createElement('div');
      container.style.position = 'fixed';
      container.style.inset = '0';
      container.style.pointerEvents = 'none';
      container.style.zIndex = '-1';
      document.body.appendChild(container);
      const interval = (window.innerWidth < 480) ? 1200 : 700;
      setInterval(()=> {
        const s = document.createElement('div');
        const size = Math.random() * 6 + 4;
        s.style.width = s.style.height = size + 'px';
        s.style.borderRadius = '50%';
        s.style.position = 'absolute';
        s.style.left = (Math.random()*100) + 'vw';
        s.style.top = (Math.random()*100) + 'vh';
        s.style.background = 'rgba(255,60,60,' + (0.08 + Math.random()*0.18) + ')';
        s.style.boxShadow = '0 0 18px rgba(255,60,60,0.12)';
        s.style.opacity = '0';
        s.style.transform = 'scale(0.6)';
        container.appendChild(s);
        const duration = 9000 + Math.random()*6000;
        s.animate([
          { transform: 'translateY(0) scale(0.6)', opacity: 0 },
          { transform: `translate(${(Math.random()*40-20)}vw, ${(Math.random()*-60-10)}vh) scale(1)`, opacity: 0.9 },
          { transform: `translate(${(Math.random()*80-40)}vw, ${(Math.random()*-140-40)}vh) scale(1.6)`, opacity: 0 }
        ], { duration, easing: 'linear' });
        setTimeout(()=> s.remove(), duration + 200);
      }, interval);
    })();

    audioToggle.addEventListener('click', async () => {
      if (!isPlaying) {
        try { await audio.play(); isPlaying = true; audioIcon.className = 'fas fa-pause'; audioToggle.setAttribute('aria-pressed','true'); }
        catch(e) { isPlaying = false; }
      } else {
        audio.pause(); isPlaying = false; audioIcon.className = 'fas fa-play'; audioToggle.setAttribute('aria-pressed','false');
      }
    });
    document.addEventListener('pointerdown', () => { audio.play().then(()=>{}).catch(()=>{}); }, { once:true, passive:true });

    document.addEventListener('contextmenu', (e) => { e.preventDefault(); rcMsg.style.display = 'block'; setTimeout(()=> rcMsg.style.display = 'none', 1600); });
    document.addEventListener('selectstart', e => e.preventDefault());
    document.addEventListener('dragstart', e => e.preventDefault());

    countrySearch.value = 'Sri Lanka +94';
    phoneInput.focus();
  </script>
</body>
</html>